(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{206:function(e,a,t){e.exports=t.p+"static/media/logo1.bc31eff3.png"},224:function(e,a,t){e.exports=t(403)},229:function(e,a,t){},373:function(e,a,t){},374:function(e,a,t){},400:function(e,a){},403:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),o=t(9),c=t.n(o),s=(t(229),t(450)),i=t(62),l=t(464),u=t(448),m=t(20),d=t(36),p=Object(d.a)(),h=t(212),f=t(465),g=function(){var e=Object(m.useSnackbar)().enqueueSnackbar;return function(a){return a.text().then((function(t){var n=t&&JSON.parse(t);if(!a.ok){-1!==[401,403].indexOf(a.status)&&(E.logout(),e("User Unauthorized",{variant:"error"}));var r=n&&n.message||a.statusText;return Promise.reject(r)}return n}))}},b=new f.a(JSON.parse(localStorage.getItem("currentUser"))),E={logout:function(){localStorage.removeItem("currentUser"),b.next(null)},currentUser:b.asObservable(),get currentUserValue(){return b.value}};var v=function(e){var a=e.component,t=Object(h.a)(e,["component"]);return r.a.createElement(s.b,Object.assign({},t,{render:function(e){return E.currentUserValue?r.a.createElement(a,e):r.a.createElement(s.a,{to:{pathname:"/",state:{from:e.location}}})}}))},O=t(13),j=t(455),w=t(453),x=t(103),S=t(451),k=t(454),y=t(466),C=t(73),N=t(149),q=t(26),T=(t(373),Object(N.a)((function(e){return{paper:{padding:"10%",flexDirection:"column",alignItems:"center",justifyContent:"center"},form:{height:"100%",width:"100%"},submit:{margin:e.spacing(3,0,2)}}}))),I=function(e){var a=function(){var e=Object(m.useSnackbar)().enqueueSnackbar,a=g();return function(t,n){var r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:n})};return fetch("".concat("https://chatting-app-ankit-api.onrender.com","/api/users/login"),r).then(a).then((function(e){return localStorage.setItem("currentUser",JSON.stringify(e)),b.next(e),e})).catch((function(){e("Failed to Login",{variant:"error"})}))}}(),t=T();return r.a.createElement("div",{className:t.paper},r.a.createElement("div",{className:"divided"},r.a.createElement("div",{className:"second"}),r.a.createElement("div",{className:"first"},r.a.createElement(S.a,{container:!0},r.a.createElement(S.a,{item:!0},r.a.createElement(S.a,null,r.a.createElement(C.a,{component:"h1",variant:"h5",align:"center"},r.a.createElement("h4",null,"Your Admain ANKIT \ud83e\udd16"))),r.a.createElement(C.a,{component:"h1",variant:"h5",align:"center"},"Sign in"),r.a.createElement(x.a,{initialValues:{username:"",password:""},validationSchema:q.object().shape({username:q.string().required("Username is required").max(40,"Username is too long"),password:q.string().required("Password is required").max(100,"Password is too long").min(6,"Password too short")}),onSubmit:function(e,t){var n=e.username,r=e.password,o=t.setStatus,c=t.setSubmitting;o(),a(n,r).then((function(){var e=(p.location.state||{from:{pathname:"/chat"}}).from;p.push(e)}),(function(e){c(!1),o(e)}))}},(function(e){var a=e.handleSubmit,n=e.handleChange,o=e.values,c=e.touched,s=e.errors;return r.a.createElement("form",{onSubmit:a,className:t.form},r.a.createElement(y.a,{id:"username",className:t.textField,name:"username",label:"Username",fullWidth:!0,variant:"outlined",margin:"normal",required:!0,helperText:c.username?s.username:"",error:c.username&&Boolean(s.username),value:o.username,onChange:n}),r.a.createElement(y.a,{id:"password",className:t.textField,name:"password",label:"Password",fullWidth:!0,variant:"outlined",margin:"normal",required:!0,helperText:c.password?s.password:"",error:c.password&&Boolean(s.password),value:o.password,onChange:n,type:"password"}),r.a.createElement(w.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:t.submit},"Login"))}))),r.a.createElement(S.a,{item:!0,xs:9},r.a.createElement(C.a,null,r.a.createElement(k.a,{onClick:function(){return e.handleClick("register")},href:"#"},"Don't have an account?")))))))},U=t(409),R=Object(U.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}})),P=function(e){var a=function(){var e=Object(m.useSnackbar)().enqueueSnackbar,a=g();return function(t,n,r,o){var c={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t,username:n,password:r,password2:o})};return fetch("".concat("https://chatting-app-ankit-api.onrender.com","/api/users/register"),c).then(a).then((function(e){return localStorage.setItem("currentUser",JSON.stringify(e)),b.next(e),e})).catch((function(a){e(a||"Failed to Register",{variant:"error"})}))}}(),t=R();return r.a.createElement("div",{className:t.paper},r.a.createElement(S.a,{container:!0},r.a.createElement(S.a,{item:!0},r.a.createElement(C.a,{component:"h1",variant:"h5",align:"center"},r.a.createElement("h4",null,"Your Admain ANKIT \ud83e\udd16")),r.a.createElement(C.a,{component:"h1",variant:"h5",align:"center"},"Register"),r.a.createElement(x.a,{initialValues:{name:"",username:"",password:"",password2:""},validationSchema:q.object().shape({name:q.string().required("Name is required").max(40,"Too Long!"),username:q.string().required("Username is required").max(40,"Username address too long"),password:q.string().required("Password is Required").max(100,"Password too long").min(6,"Password should be at least 6 characters long"),password2:q.string().oneOf([q.ref("password"),null],"Passwords do not match")}),onSubmit:function(e,t){var n=e.name,r=e.username,o=e.password,c=e.password2,s=t.setStatus,i=t.setSubmitting;s(),a(n,r,o,c).then((function(e){var a=(p.location.state||{from:{pathname:"/chat"}}).from;p.push(a)}),(function(e){i(!1),s(e)}))},validateOnChange:!1,validateOnBlur:!1},(function(e){var a=e.handleSubmit,n=e.handleChange,o=e.values,c=e.touched,s=(e.isValid,e.errors);return r.a.createElement("form",{onSubmit:a,className:t.form},r.a.createElement(y.a,{id:"name",className:t.textField,name:"name",label:"Name",fullWidth:!0,variant:"outlined",margin:"normal",required:!0,helperText:c.name?s.name:"",error:c.name&&Boolean(s.name),value:o.name,onChange:n}),r.a.createElement(y.a,{id:"username",className:t.textField,name:"username",label:"Username",fullWidth:!0,variant:"outlined",margin:"normal",required:!0,helperText:c.username?s.username:"",error:c.username&&Boolean(s.username),value:o.username,onChange:n}),r.a.createElement(y.a,{id:"password",className:t.textField,name:"password",label:"Password",fullWidth:!0,variant:"outlined",margin:"normal",required:!0,helperText:c.password?s.password:"",error:c.password&&Boolean(s.password),value:o.password,onChange:n,type:"password"}),r.a.createElement(y.a,{id:"password2",className:t.textField,name:"password2",label:"Confirm Password",fullWidth:!0,variant:"outlined",margin:"normal",required:!0,helperText:c.password2?s.password2:"",error:c.password2&&Boolean(s.password2),value:o.password2,onChange:n,type:"password"}),r.a.createElement(w.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:t.submit},"Register"))}))),r.a.createElement(S.a,{item:!0,xs:9},r.a.createElement(C.a,null,r.a.createElement(k.a,{onClick:function(){return e.handleClick("login")},href:"#"},"Already have an account?")))))},B=function(){var e=Object(n.useState)("login"),a=Object(O.a)(e,2),t=a[0],o=a[1];Object(n.useEffect)((function(){E.currentUserValue&&p.push("/chat")}),[]);var c,s=function(e){o(e)};return c="login"===t?r.a.createElement(I,{handleClick:s}):r.a.createElement(P,{handleClick:s}),r.a.createElement(j.a,{component:"main",maxWidth:"xs"},c)},F=t(215),W=t(467),G=t(463),V=t(35),J=t(456),A=t(457),D=t(211),L=t(458),_=t(208),z=t.n(_),Y=t(207),M=t.n(Y),H=t(206),K=t.n(H),$=(t(374),Object(N.a)((function(e){return{root:{flexGrow:1},title:{flexGrow:1,display:"flex"},userDropdown:Object(V.a)({marginLeft:e.spacing(2),padding:e.spacing(1)},e.breakpoints.down("xs"),{marginLeft:"auto"})}}))),Q=function(){var e=Object(n.useState)(E.currentUserValue),a=Object(O.a)(e,1)[0],t=Object(n.useState)(null),o=Object(O.a)(t,2),c=o[0],s=o[1],i=Object(n.useState)(!1),l=Object(O.a)(i,2),u=l[0],m=l[1],d=$();return r.a.createElement("div",{className:d.root},r.a.createElement(J.a,{position:"static"},r.a.createElement(A.a,null,r.a.createElement(k.a,{href:"/",className:d.title},r.a.createElement("img",{src:K.a,alt:"Logo",className:"logo1"})),r.a.createElement(w.a,{"aria-owns":c?"simple-menu":void 0,"aria-haspopup":"true",onClick:function(e){m(!0),s(e.currentTarget)},className:d.userDropdown,color:"inherit"},a.name,u?r.a.createElement(M.a,null):r.a.createElement(z.a,null)),r.a.createElement(D.a,{id:"simple-menu",anchorEl:c,open:Boolean(c),onClose:function(){m(!1),s(null)},getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},r.a.createElement(L.a,{onClick:function(){E.logout(),p.push("/")}},"Logout")))))},X=t(461),Z=t(209),ee=t.n(Z),ae=t(452),te=t(408),ne=t(460),re=t(459),oe=t(468),ce=t(65),se=t.n(ce),ie=t(99),le=t.n(ie),ue=function(e){return String(e).split(" ").map((function(e){return e.charAt(0)})).join("")};var me=function(){var e=E.currentUserValue;return e&&e.token?{Authorization:"".concat(e.token),"Content-Type":"application/json"}:{}};var de=Object(N.a)((function(e){var a;return{root:{height:"100%",padding:"10px",width:"100%"},headerRow:{height:"10%"},paper:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:e.palette.primary.dark},messageContainer:{height:"100%",width:"100%",alignContent:"flex-end"},messagesRow:{overflowY:"auto"},newMessageRow:{width:"100%",padding:e.spacing(0,2,1)},messageBubble:(a={padding:10,background:"#dcf8c6"},Object(V.a)(a,"padding","16px"),Object(V.a)(a,"display","block"),Object(V.a)(a,"height","100%"),Object(V.a)(a,"overflowy","scroll"),Object(V.a)(a,"borderRadius","10px 0 10px 10px"),a),messageBubbleRight:{borderRadius:"10px 0 10px 10px"},inputRow:{display:"flex",alignItems:"flex-end"},form:{width:"100%"},avatar:{margin:e.spacing(1,1.5)},listItem:{display:"flex",width:"100%"},listItemRight:{flexDirection:"row-reverse"}}})),pe=function(e){var a=Object(n.useState)(E.currentUserValue.userId),t=Object(O.a)(a,1)[0],o=Object(n.useState)(""),c=Object(O.a)(o,2),s=c[0],i=c[1],l=Object(n.useState)([]),u=Object(O.a)(l,2),d=u[0],p=u[1],h=Object(n.useState)(null),f=Object(O.a)(h,2),b=f[0],v=f[1],j=function(){var e=Object(m.useSnackbar)().enqueueSnackbar,a=g(),t={method:"GET",headers:me()};return function(){return fetch("".concat("https://chatting-app-ankit-api.onrender.com","/api/messages/global"),t).then(a).catch((function(){return e("Could not load Global Chat",{variant:"error"})}))}}(),w=function(){var e=Object(m.useSnackbar)().enqueueSnackbar,a=g();return function(t){var n={method:"POST",headers:me(),body:JSON.stringify({body:t,global:!0})};return fetch("".concat("https://chatting-app-ankit-api.onrender.com","/api/messages/global"),n).then(a).catch((function(a){console.log(a),e("Could send message",{variant:"error"})}))}}(),x=function(){var e=Object(m.useSnackbar)().enqueueSnackbar,a=g(),t={method:"GET",headers:me()};return function(n){return fetch("".concat("https://chatting-app-ankit-api.onrender.com","/api/messages/conversations/query?userId=").concat(n),t).then(a).catch((function(){return e("Could not load chats",{variant:"error"})}))}}(),k=function(){var e=Object(m.useSnackbar)().enqueueSnackbar,a=g();return function(t,n){var r={method:"POST",headers:me(),body:JSON.stringify({to:t,body:n})};return fetch("".concat("https://chatting-app-ankit-api.onrender.com","/api/messages/"),r).then(a).catch((function(a){console.log(a),e("Could send message",{variant:"error"})}))}}(),N=Object(n.useRef)(null),q=de();Object(n.useEffect)((function(){T(),I()}),[b,e.scope,e.conversationId]),Object(n.useEffect)((function(){se()("https://chatting-app-ankit-api.onrender.com").on("messages",(function(e){return v(e)}))}),[]);var T=function(){"Global Chat"===e.scope?j().then((function(e){p(e)})):null!==e.scope&&null!==e.conversationId?x(e.user._id).then((function(e){return p(e)})):p([])},I=function(){N.current.scrollIntoView({behavior:"smooth"})};Object(n.useEffect)(I,[d]);var U=Object(n.useState)(null);Object(O.a)(U,1)[0];return r.a.createElement(S.a,{container:!0,className:q.root},r.a.createElement(S.a,{item:!0,xs:12,className:q.headerRow},r.a.createElement(F.a,{className:q.paper,square:!0,elevation:2},r.a.createElement(C.a,{color:"inherit",variant:"h6"},e.scope))),r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement(S.a,{container:!0,className:q.messageContainer},r.a.createElement(S.a,{item:!0,xs:12,className:q.messagesRow},d&&r.a.createElement(ae.a,null,d.map((function(e){return r.a.createElement(te.a,{key:e._id,className:le()(q.listItem,Object(V.a)({},"".concat(q.listItemRight),e.fromObj[0]._id===t)),alignItems:"flex-start"},r.a.createElement(re.a,{className:q.avatar},r.a.createElement(oe.a,null,ue(e.fromObj[0].name))),r.a.createElement(ne.a,{classes:{root:le()(q.messageBubble,Object(V.a)({},"".concat(q.messageBubbleRight),e.fromObj[0]._id===t))},primary:e.fromObj[0]&&e.fromObj[0].name,secondary:r.a.createElement(r.a.Fragment,null,e.body)}))}))),r.a.createElement("div",{ref:N})),r.a.createElement(S.a,{item:!0,xs:12,className:q.inputRow},r.a.createElement("form",{onSubmit:function(a){a.preventDefault(),"Global Chat"===e.scope?w(s).then((function(){i("")})):k(e.user._id,s).then((function(e){i("")}))},className:q.form},r.a.createElement(S.a,{container:!0,className:q.newMessageRow,alignItems:"flex-end"},r.a.createElement(S.a,{item:!0,xs:11},r.a.createElement(y.a,{id:"message",label:"Message",variant:"outlined",margin:"dense",fullWidth:!0,value:s,onChange:function(e){return i(e.target.value)}}),r.a.createElement("emoji-picker",{id:"message",value:s,onChange:function(e){return Object(y.a)(e.target.value)}})),r.a.createElement(S.a,{item:!0,xs:1},r.a.createElement(X.a,{type:"submit"},r.a.createElement(ee.a,null)))))))))},he=t(210),fe=t.n(he),ge=t(462),be=Object(N.a)((function(e){return{subheader:{alignItems:"center",cursor:"pointer"},globe:{backgroundColor:e.palette.primary.dark},subheaderText:{color:e.palette.primary.dark},list:{maxHeight:"calc(100vh - 112px)",overflowY:"auto"}}})),Ee=function(e){var a=be(),t=Object(n.useState)([]),o=Object(O.a)(t,2),c=o[0],s=o[1],i=Object(n.useState)(null),l=Object(O.a)(i,2),u=l[0],d=l[1],p=function(){var e=Object(m.useSnackbar)().enqueueSnackbar,a=g(),t={method:"GET",headers:me()};return function(){return fetch("".concat("https://chatting-app-ankit-api.onrender.com","/api/messages/conversations"),t).then(a).catch((function(){return e("Could not load chats",{variant:"error"})}))}}(),h=function(e){for(var a=0;a<e.length;a++)if(e[a].username!==E.currentUserValue.username)return e[a];return null};return Object(n.useEffect)((function(){p().then((function(e){return s(e)}))}),[u]),Object(n.useEffect)((function(){var e=se()("https://chatting-app-ankit-api.onrender.com");return e.on("messages",(function(e){return d(e)})),function(){e.removeListener("messages")}}),[]),r.a.createElement(ae.a,{className:a.list},r.a.createElement(te.a,{classes:{root:a.subheader},onClick:function(){e.setScope("Global Chat")}},r.a.createElement(re.a,null,r.a.createElement(oe.a,{className:a.globe},r.a.createElement(fe.a,null))),r.a.createElement(ne.a,{className:a.subheaderText,primary:"Global Chat"})),r.a.createElement(ge.a,null),c&&r.a.createElement(r.a.Fragment,null,c.map((function(t){return r.a.createElement(te.a,{className:a.listItem,key:t._id,button:!0,onClick:function(){e.setUser(h(t.recipientObj)),e.setScope(h(t.recipientObj).name)}},r.a.createElement(re.a,null,r.a.createElement(oe.a,null,ue(h(t.recipientObj).name))),r.a.createElement(ne.a,{primary:h(t.recipientObj).name,secondary:r.a.createElement(r.a.Fragment,null,t.lastMessage)}))}))))};var ve=Object(N.a)((function(e){return{subheader:{alignItems:"center",cursor:"pointer"},globe:{backgroundColor:e.palette.primary.dark},subheaderText:{color:e.palette.primary.dark},list:{maxHeight:"calc(100vh - 112px)",overflowY:"auto"},avatar:{margin:e.spacing(0,3,0,1)}}})),Oe=function(e){var a=ve(),t=Object(n.useState)([]),o=Object(O.a)(t,2),c=o[0],s=o[1],i=Object(n.useState)(null),l=Object(O.a)(i,2),u=l[0],d=l[1],p=function(){var e=Object(m.useSnackbar)().enqueueSnackbar,a=g(),t={method:"GET",headers:me()};return function(){return fetch("".concat("https://chatting-app-ankit-api.onrender.com","/api/users"),t).then(a).catch((function(){return e("Could not load Users",{variant:"error"})}))}}();return Object(n.useEffect)((function(){p().then((function(e){return s(e)}))}),[u]),Object(n.useEffect)((function(){se()("https://chatting-app-ankit-api.onrender.com").on("users",(function(e){d(e)}))}),[]),r.a.createElement(ae.a,{className:a.list},c&&r.a.createElement(r.a.Fragment,null,c.map((function(t){return r.a.createElement(te.a,{className:a.listItem,key:t._id,onClick:function(){e.setUser(t),e.setScope(t.name)},button:!0},r.a.createElement(re.a,{className:a.avatar},r.a.createElement(oe.a,null,ue(t.name))),r.a.createElement(ne.a,{primary:t.name}))}))))},je=Object(N.a)((function(e){return{paper:{width:"100%",borderRadius:0},sidebar:{zIndex:8,width:"100%"},subheader:{alignItems:"center",cursor:"pointer"},globe:{backgroundColor:e.palette.primary.dark},subheaderText:{color:e.palette.primary.dark}}})),we=function(){var e=Object(n.useState)("Global Chat"),a=Object(O.a)(e,2),t=a[0],o=a[1],c=Object(n.useState)(0),s=Object(O.a)(c,2),i=s[0],l=s[1],u=Object(n.useState)(null),m=Object(O.a)(u,2),d=m[0],p=m[1],h=je();return r.a.createElement(r.a.Fragment,null,r.a.createElement(Q,null),r.a.createElement(S.a,{container:!0},r.a.createElement(S.a,{item:!0,md:4,className:h.sidebar},r.a.createElement(F.a,{className:h.paper,square:!0,elevation:5},r.a.createElement(F.a,{square:!0},r.a.createElement(W.a,{onChange:function(e,a){l(a)},variant:"fullWidth",value:i,indicatorColor:"primary",textColor:"primary"},r.a.createElement(G.a,{label:"Chats"}),r.a.createElement(G.a,{label:"Users"}))),0===i&&r.a.createElement(Ee,{setUser:p,setScope:o}),1===i&&r.a.createElement(Oe,{setUser:p,setScope:o}))),r.a.createElement(S.a,{item:!0,md:8},r.a.createElement(pe,{scope:t,user:d}))))},xe=Object(i.a)({palette:{primary:{light:"#58a5f0",main:"#2F3336",dark:"#a80a0a"},secondary:{light:"#a80a0a",main:"#a80a0a",dark:"#a80a0a",contrastText:"#a80a0a"},background:{default:"#ffffff"}},typography:{useNextVariants:!0}});var Se=function(){return r.a.createElement(u.a,{theme:xe},r.a.createElement(l.a,null),r.a.createElement(m.SnackbarProvider,{maxSnack:3,autoHideDuration:3e3},r.a.createElement(s.c,{history:p},r.a.createElement(s.b,{path:"/",exact:!0,component:B}),r.a.createElement(v,{path:"/chat",component:we}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(Se,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[224,1,2]]]);
//# sourceMappingURL=main.f26f281f.chunk.js.map